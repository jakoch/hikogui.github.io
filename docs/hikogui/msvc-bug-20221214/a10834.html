<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HikoGUI: Code Style</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="version_dropdown.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HikoGUI
   </div>
   <div id="projectbrief">A low latency retained GUI</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Code Style</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md78"></a>
Identifiers</h1>
<h2><a class="anchor" id="autotoc_md79"></a>
Casing</h2>
<p>The following identifiers are in snake_case:</p>
<ul>
<li>functions,</li>
<li>member functions,</li>
<li>variables,</li>
<li>member variables,</li>
<li>arguments,</li>
<li>enum values,</li>
<li>struct types,</li>
<li>union types,</li>
<li>enum types,</li>
<li>concepts.</li>
</ul>
<p>The following identifiers are in CamelCase:</p>
<ul>
<li>template arguments.</li>
</ul>
<p>Capital letters within a snake_case identifier are allowed for proper nouns and abbreviations.</p>
<h2><a class="anchor" id="autotoc_md80"></a>
Common names</h2>
<p>Common identifiers:</p>
<ul>
<li><code>i</code>, <code>j</code>, <code>k</code>: Index inside a loop.</li>
<li><code>it</code>, <code>jt</code>, <code>kt</code>: Iterator inside a loop.</li>
<li><code>r</code>: Return value being prepared.</li>
<li><code>first</code>, <code>last</code>: Iterator arguments to a function.</li>
</ul>
<h2><a class="anchor" id="autotoc_md81"></a>
Prefixes and Suffixes</h2>
<p>Common prefixes and suffixes:</p>
<ul>
<li>prefix <code>num_</code>: Size of a list of items. The prefixed name should be plural</li>
<li>suffix <code>_nr</code>: Ordinal of an item.</li>
<li>suffix <code>_i</code> <code>_j</code> <code>_k</code>: Index inside a loop associated with an specific list.</li>
<li>suffix <code>_it</code> <code>_jt</code> <code>_kt</code>: Iterator inside a loop associated with an specific list.</li>
<li>prefix <code>_</code>: Private or protected member variables and functions.</li>
<li>suffix <code>_</code>: A variable after conversion to a different type.</li>
<li>suffix <code>_type</code>: A type created inside a class.</li>
<li>prefix <code>hi_</code>: A macro</li>
<li>suffix <code>_cbt</code>: A callback-token returned when subscribing a callback.</li>
</ul>
<p>Private or protected member variables are prefixed with "\_", so that getter/setter member functions names will not alias with the variables.</p>
<p>Private or protected member functions may have the "\_" prefix when they implement the functionality of a public function of the same name.</p>
<p>Macros, because they do not belong to a namespace, are prefixed with the prefix "hi\_".</p>
<p>The suffix "\_" may be used when a new variable needs to be introduced when only its type has changed using casting or conversion. If more than one such variable is needed the name of the type should be appended.</p>
<h1><a class="anchor" id="autotoc_md82"></a>
Getters and Setters</h1>
<p>I prefer public member variables. In case a member variable must be protected or private due to class-invariance then we may add a getter or a setter.</p>
<p>Since protected and private member variables are prefixed with "\_" we can use the non-prefixed name for the getter. And we can use the "set\_" prefix for setters.</p>
<p>When the getter returns a non-constant reference to the data member, a separate setter is not needed.</p>
<h1><a class="anchor" id="autotoc_md83"></a>
Initializing variables</h1>
<p>I would like to see an assignment operator <code>=</code> with every variable initialization. Here are some examples that are acceptable:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> foo = foo_type{init_value};</div>
<div class="line"><span class="keyword">auto</span> foo = foo_type(init_value);</div>
<div class="line">foo_type foo = foo_type{init_value};</div>
<div class="line">foo_type foo = {init_value};</div>
<div class="line">foo_type foo = init_value;</div>
</div><!-- fragment --><p>Please do NOT use the following variable initialization as I find it difficult to read:</p>
<div class="fragment"><div class="line">foo_type foo(init_value);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md84"></a>
Global variables</h1>
<p>Singletons (classes that can only be instantiated once) are discouraged.</p>
<p>Instead, add a static-member-function to the class, which returns a reference to an instance of that class. When there is only one such member, call it <code>global()</code>.</p>
<p>In certain cases, these <code>global()</code> member functions have to initialize a subsystem and/or make sure that it is not being allocated during system shutdown. The <code>system_status</code> will help with correctly instantiating and closing down of subsystems,</p>
<p>If it is not possible to add a static-member-function due to circular dependencies than naming a global variable as the name of the class followed by the name of the global variable with and underscore "\_" as separator.</p>
<p>Another interesting global variable, either as a static-member-variable or as a global variable would be a mutex named <code>mutex</code>.</p>
<h1><a class="anchor" id="autotoc_md85"></a>
Two phase construction</h1>
<p>When a polymorphic class needs polymorphic initialization and destruction, it should add the following two virtual functions:</p>
<ul>
<li>virtual void <code>init()</code></li>
<li>virtual void <code>deinit()</code></li>
</ul>
<p><code>init()</code> should be called directly after the lifetime of the object has started. It should be called from the same thread as its construction and the reference to the object should not have been shared with others.</p>
<p><code>deinit()</code> should be called directly before the lifetime of the object is finished. It should be called from the same thread as the object's destructor and no reference to the object should exist anymore outside of the current function.</p>
<p>This means that like in the constructor and destructor inside <code>init()</code> and <code>deinit()</code> there is no need for handling multithreading issues.</p>
<h1><a class="anchor" id="autotoc_md86"></a>
Delegates</h1>
<p>Delegates are polymorphic class instances that are passed to an object that is being managed. The managed object will call into the delegate to send messages and retrieve information.</p>
<p>The managed object should hold a <code><a class="elRef" href="http://en.cppreference.com/w/cpp/memory/weak_ptr.html">std::weak_ptr</a></code> to the base class of the delegate. This allows the delegate to be deallocated with the managed object functioning.</p>
<p>When calling the delegate, the first argument <code>sender</code> should be a reference to the managed object.</p>
<p>Delegates should at least have the following two function to handle the lifetime of the managed object:</p>
<ul>
<li>virtual void init(managed_object &amp;sender)</li>
<li>virtual void deinit(managed_object &amp;sender)</li>
</ul>
<p>The two functions mirror the two phase construction and are often called from <code>init()</code> and <code>deinit()</code> of the managed object. However, they may be called from the constructor and destructor of the object as well.</p>
<h1><a class="anchor" id="autotoc_md87"></a>
Subsystems</h1>
<p>A subsystem will have a name in the <code>system_status_type</code> enum, and will have a global function under the same name suffixed with _start. This subsystem_start function is used to initialize and register the deinitialize function with the system_status. The subsystem_start function must be low latency so that it can be called very often to make sure the subsystem is started when functionality of the subsystem is used for the first time.</p>
<h1><a class="anchor" id="autotoc_md88"></a>
Paths</h1>
<p>Remember if you are converting between <code><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></code> and <code>std::filesystem::path</code> you are doing something wrong. With std::filesystem::path a <code>char</code> is the native-narrow-encoding, this is different from the rest of the C++ standard where <code>char</code> is in the execution-encoding.</p>
<p>The execution-encoding on HikoGUI is set using compiler options to UTF-8. The native-narrow-encoding is Window's currently configured code-page for this process and is compatible with the <code>*A()</code> win32 functions.</p>
<p>It is highly recommended NOT to use the <code>*A()</code> win32 functions and instead use the <code>*W()</code> win32 functions. The <code>*A()</code> win32 function do extra encoding and decoding from the current configured code-page to UTF-16-like encoding and then call the matching <code>*W()</code> function internally.</p>
<p>So use the <code>std::filesystem::path</code> explicit <code>std::u8string</code>, <code><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::u16string</a></code> and <code><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::u32string</a></code> conversions and then convert to and from <code><a class="elRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></code> using the <code>hi::to_*string()</code> functions. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.8-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 29 2023 19:33:32 for HikoGUI by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
<script>
mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    themeVariables: {
    primaryColor: '#f4f4ff',
    secondaryColor: 'rgba(244,244,255,0.9)',
    tertiaryColor: '#F9FAFC',
    },
});
</script>
</body>
</html>
</html>