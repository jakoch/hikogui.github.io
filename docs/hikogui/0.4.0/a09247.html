<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HikoGUI: Color</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="version_dropdown.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HikoGUI
   </div>
   <div id="projectbrief">A low latency retained GUI</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Color</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document describes how color is used in the ttauri library.</p>
<h1><a class="anchor" id="autotoc_md18"></a>
Usage of color spaces</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Usage   </th><th class="markdownTableHeadLeft">Space   </th><th class="markdownTableHeadLeft">depth   </th><th class="markdownTableHeadLeft">alpha    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">draw API   </td><td class="markdownTableBodyLeft">tsRGB   </td><td class="markdownTableBodyLeft">float32   </td><td class="markdownTableBodyLeft">straight    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">vertices   </td><td class="markdownTableBodyLeft">tsRGB   </td><td class="markdownTableBodyLeft">float16   </td><td class="markdownTableBodyLeft">straight    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">images   </td><td class="markdownTableBodyLeft">tsRGB   </td><td class="markdownTableBodyLeft">float16   </td><td class="markdownTableBodyLeft">pre-multiplied    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">fragment shaders   </td><td class="markdownTableBodyLeft">tsRGB   </td><td class="markdownTableBodyLeft">float32   </td><td class="markdownTableBodyLeft">pre-multiplied    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">frame buffers   </td><td class="markdownTableBodyLeft">tsRGB   </td><td class="markdownTableBodyLeft">float16   </td><td class="markdownTableBodyLeft">pre-multiplied    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">swap chain   </td><td class="markdownTableBodyLeft">sRGB*   </td><td class="markdownTableBodyLeft">uint8*   </td><td class="markdownTableBodyLeft">pre-multiplied   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md19"></a>
PNG decoding</h2>
<p>TTauri's PNG decoder will create an image of float16 RGBA values in the tsRGB color space. The rgb values in the resulting image are pre-multiplied by the alpha.</p>
<p>The PNG decoder will use the color space and transfer function information from the PNG data to do the conversion of pixel values to the tsRGB color space.</p>
<p>sRGB color space and transfer function is implied if color space information is not available in the PNG data.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Theme files</h2>
<p>The colors in ttauri's theme file may be edited by users, there are three different ways of specifying colors.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Format   </th><th class="markdownTableHeadLeft">Color space    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">'#' 6 or 8 hex digits   </td><td class="markdownTableBodyLeft">sRGB    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">3 or 4 integers   </td><td class="markdownTableBodyLeft">sRGB    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">3 or 4 floating point numbers   </td><td class="markdownTableBodyLeft">tsRGB   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md21"></a>
Swap chain</h2>
<p>The swap chain images are the ones that are presented to the desktop compositor.</p>
<p>On windows 10 this will be 8-bit sRGB. On Windows 10 HDR/high gamut formats are only available for full screen applications.</p>
<p>On MacOS the swap chain will be in tsRGB float16, where the desktop compositor is able to handle HDR/high gamut in the tsRGB format.</p>
<h1><a class="anchor" id="autotoc_md22"></a>
tsRGB color space</h1>
<p>The tsRGB color space is actually very common but never explicitly named. Here are examples of very simular color spaces:</p>
<ul>
<li><em>scRGB</em>, specified for 16 bit biased and scaled integers with a range between -0.5 and 7.5. Often used outside of this spec as float16 or float32 with extended range.</li>
<li><em>Extended-sRGB</em>, specified with a non-linear transfer function that is mirrored for negative values. Often used outside of this spec using a linear transfer function.</li>
<li>The unnamed color space of float16 linear RGB swap-chain images.</li>
</ul>
<p>The tsRGB color space has the same color primaries and white-point as the sRGB/BT.709 color spaces.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft"></th><th class="markdownTableHeadRight">x   </th><th class="markdownTableHeadRight">y   </th><th class="markdownTableHeadRight">Luminosity contribution    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Red   </td><td class="markdownTableBodyRight">0.6400   </td><td class="markdownTableBodyRight">0.3300   </td><td class="markdownTableBodyRight">0.2126    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Green   </td><td class="markdownTableBodyRight">0.3000   </td><td class="markdownTableBodyRight">0.6000   </td><td class="markdownTableBodyRight">0.7152    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Blue   </td><td class="markdownTableBodyRight">0.1500   </td><td class="markdownTableBodyRight">0.0600   </td><td class="markdownTableBodyRight">0.0722    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">White D65   </td><td class="markdownTableBodyRight">0.3127   </td><td class="markdownTableBodyRight">0.3290   </td><td class="markdownTableBodyRight"></td></tr>
</table>
<p>The RGB values have a linearly transfer function where RGB(0.0, 0.0, 0.0) is black and RGB(1.0, 1.0, 1.0) is white with a luminance 80 cd/m2. Values above 1.0 will produce higher luminance values available on HDR monitors.</p>
<p>When all RGB values are within 0.0 and 1.0 the tsRGB color space is fully compatible with linear sRGB.</p>
<p>Negative color component values will allow colors outside of the sRGB gamut triangle, which may be rendered on high gamut monitors. However the luminosity of the color must be greater or equal to zero.</p>
<h1><a class="anchor" id="autotoc_md23"></a>
tYUV/tLUV related color space</h1>
<p>The tLUV color space is used for mixing background and foreground colors for anti-aliasing text, where the perceived line width is an important attribute. For more detailed information see: <a href="https://www.ttauri-project.org/2021/03/30/the-trouble-with-anti-aliasing.html">The trouble with anti-aliasing</a></p>
<p>Conversion from tRGB to tYUV/tLUV:</p>
<div class="fragment"><div class="line">Y = R * 0.2126 + G * 0.7152 + B * 0.0722</div>
<div class="line">L = sqrt(Y)</div>
<div class="line">U = B - Y</div>
<div class="line">V = R - Y</div>
</div><!-- fragment --><p>Conversion from tYUV/tLUB to tRGB:</p>
<div class="fragment"><div class="line">Y = L * L</div>
<div class="line">R = V + Y</div>
<div class="line">B = U + Y</div>
<div class="line">G = Y - V * 0.2973 - Y * 0.1001</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24"></a>
The color types</h1>
<h2><a class="anchor" id="autotoc_md25"></a>
color</h2>
<p>The <code>color</code> type is a 32 bit floating point 3D RGB vector + alpha scalar.</p>
<p>The RGB values are linear and may comprise the complete floating point range, including values above 1.0 and value below zero.</p>
<p>The alpha value is a linear value between 0.0 (transparent) and 1.0 (opaque).</p>
<p>Depending on where the colors are used the RGB values are pre-multiplied by the alpha value, for example: inside fragment shaders, images and frame buffers.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
matrix3</h2>
<p>A color conversion matrix can be stored in the <code>matrix3</code> type. And a <code>color</code> value can be transformed by a <code>matrix3</code>. This transformation ignores and preserves the alpha value.</p>
<h2><a class="anchor" id="autotoc_md27"></a>
color storage</h2>
<p>Color format types are used in vertex arrays and images when communicating with the GPU.</p>
<p>The types have the following syntax: <code>numeric-type</code> _ <code>color-components</code> [ _pack ]</p>
<h3><a class="anchor" id="autotoc_md28"></a>
Numeric type</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Type   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">norm   </td><td class="markdownTableBodyLeft">Signed integer mapped to the floating point range between -1.0 and 1.0.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">unorm   </td><td class="markdownTableBodyLeft">Unsigned integer mapped to the floating point range between 0.0 and 1.0.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">int   </td><td class="markdownTableBodyLeft">Signed integer.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">uint   </td><td class="markdownTableBodyLeft">Unsigned integer.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">float   </td><td class="markdownTableBodyLeft">Floating point number.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">srgb   </td><td class="markdownTableBodyLeft">Non-linear sRGB format for the RGB component, the alpha remains linear.   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md29"></a>
Color components</h3>
<p>The color components are the lower case letters: r, g, b &amp; a. The ordering of the letters describe the order of the color components in memory. A number describes the number of bits of each component before it.</p>
<p>Here are a few examples of components:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Combination   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">rgba32   </td><td class="markdownTableBodyLeft">32 bits per component red, green, blue &amp; alpha.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">rgba16   </td><td class="markdownTableBodyLeft">16 bits per component red, green, blue &amp; alpha.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">rgba8   </td><td class="markdownTableBodyLeft">8 bits per component red, green, blue &amp; alpha.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">rgb8   </td><td class="markdownTableBodyLeft">8 bits per component red, green, blue.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">rg8   </td><td class="markdownTableBodyLeft">8 bits per component red, green.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">r8   </td><td class="markdownTableBodyLeft">8 bits per component red.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">abgr8   </td><td class="markdownTableBodyLeft">8 bits per component alpha, blue, green &amp; red.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">a2bgr10   </td><td class="markdownTableBodyLeft">2 bit alpha, 10 bits per component blue, green &amp; red   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md30"></a>
Packing</h3>
<p>If the format is non-packed, then each each color component must be 8, 16, 32 or 64 bits in size. Each color component is stored in memory in native-byte-order, and the components are ordered with in increasing memory addresses.</p>
<p>If the format is packed, then the color components are packed together in a single integer. The color components are packed inside the integer from msb to lsb. The integer are 8, 16, 32, 64 or 128 bits in size. The integer is stored in memory in native-byte-order. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.8-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 29 2023 19:34:58 for HikoGUI by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
<script>
mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    themeVariables: {
    primaryColor: '#f4f4ff',
    secondaryColor: 'rgba(244,244,255,0.9)',
    tertiaryColor: '#F9FAFC',
    },
});
</script>
</body>
</html>
</html>